trigger: none

pool:
  # vmImage: 'ubuntu-latest'
  name: selfhosted

jobs:
- job: BuildAndTest
  displayName: "Build, Test, and Analyze"
  steps:

    - task: SonarCloudPrepare@3
      inputs:
        SonarCloud: 'sonar-cloud'
        organization: 'brainupgrade-in'
        scannerMode: 'other'
    - task: SonarQubePrepare@5
      inputs:
        SonarQube: 'sonar-cloud'
        scannerMode: 'CLI'
        configMode: 'manual'
        cliProjectKey: 'spring-petclinic'
        cliOrganization: 'brainupgrade-in'
        extraProperties: |
          sonar.sources=.
          sonar.host.url=https://sonarcloud.io


    # Publish Quality Gate Result task
    - task: SonarCloudPublish@3
      inputs:
        pollingTimeoutSec: '300'       
